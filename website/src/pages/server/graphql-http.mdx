# graphql-http

[graphql-http](https://github.com/graphql/graphql-http) is the official reference implementation of the [GraphQL over HTTP Protocol](https://graphql.github.io/graphql-over-http/). It is simple, pluggable and zero-dependency server and client.

## Installation

```sh
npm i graphql graphql-http
```

## Start

Provide the [database](/database/introduction) GraphQL schema.

```ts filename="examples/server/graphql-http/index.ts"
import { createServer, IncomingMessage } from 'node:http';
import { createHandler } from 'graphql-http/lib/use/node';
import { sessionIdFromCookie, sessionIdToCookie } from '@server/utils';
import { buildSchema, createContext } from '@database/<slug>/schema';

const SESSION_REQUEST_TO_ID_MAP = new WeakMap<IncomingMessage, string>();

(async () => {
  const handler = createHandler({
    schema: await buildSchema(),
    context: (req) =>
      createContext({
        sessionId: sessionIdFromCookie(req.raw.headers.cookie),
        setSessionId(sessionId) {
          SESSION_REQUEST_TO_ID_MAP.set(req.raw, sessionId);
        },
      }),
  });

  const server = createServer((req, res) => {
    if (req.url?.startsWith('/graphql')) {
      const sessionId = SESSION_REQUEST_TO_ID_MAP.get(req);
      if (sessionId) {
        res.setHeader('set-cookie', sessionIdToCookie(sessionId));
      }
      handler(req, res);
    } else {
      res.writeHead(404).end();
    }
  });

  server.listen(50005);
  console.info('Server is running on http://localhost:50005/graphql');
})();
```

And run it:

```sh
npx tsx index.ts
```

Visit [`http://localhost:50005/graphql`](http://localhost:50005/graphql) to see Yoga in action.
